<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Palette</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@300&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>

<style>
    body {
        text-align: center;
        color: var(--tg-theme-text-color);
        background: var(--tg-theme-bg-color);
        font-family: 'Roboto Condensed', sans-serif;
    }

    .input {
        text-align: center;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: var(--tg-theme-bg-color, #ffffff);
        color: var(--tg-theme-button-text-color, #ffffff);
        outline: black 2px solid;
    }

    button {
        display: block;
        width: 100%;
        margin: 15px 0;
        padding: 12px 20px;
        border: none;
        border-radius: 4px;
        font-size: larger;
        background-color: var(--tg-theme-button-color, #50a8eb);
        color: var(--tg-theme-button-text-color, #ffffff);
        cursor: pointer;
        }

    .palette {
        display: flex;
        justify-content: center;
    }

    label {
        font-size: large;
    }

    div.color {
        position: relative;
        width: 20%;
        aspect-ratio: 1;
        outline: 0px solid;
    }

    .line {
        background-color: var(--tg-theme-secondary-bg-color, #50a8eb);
        width: 100%;
        height: 5px;
        visibility: visible;
    }

    .container {
        padding: 5px;
        display: flex;
        justify-content: center;
    }

    #color-picker {
        position: relative;
        width: 100%;
        height: 150px;
        margin: 5px;
        outline: 3px solid;
        outline-color: var(--tg-theme-secondary-bg-color, #50a8eb);
        cursor: pointer;
    }

    .color-cursor {
        position: absolute;
        border-radius: 100%;
        visibility: hidden;
        width:  20px;
        height: 20px;
        z-index: 10000;
        color: rgba(0, 0, 0, 0);
        box-shadow: 0px 0px 0px 1px black;        
        /* outline: 1px solid; */
        /* outline-color: var(--tg-theme-text-color, black); */
    }

</style>

<body>
    <!-- <h1>Choose your palette:</h1> -->

    <main>
    <div class="palette">
        <div class="color">
            <button class="input" onclick="selectColor(this)" id="bg" name="bg" value="#ffa656"></button>
            <!-- <input type="button" onclick="selectColor(this)" id="bg" name="bg" value="#ffa656"> -->

            <!-- <label for="bg" id="bg-text">Background color</label> -->
        </div>

        <div class="color">
            <!-- <input type="button" onclick="selectColor(this)" id="primary" name="primary" value="#ff6600"> -->
            <button class="input" onclick="selectColor(this)" id="primary" name="bg" value="#ffa656"></button>

            <!-- <label for="primary" id="primary-text">Primary color</label> -->
        </div>

        <div class="color">
            <!-- <input type="button" onclick="selectColor(this)" id="secondary" name="secondary" value="#ffd084"> -->
            <button class="input" onclick="selectColor(this)" id="secondary" name="bg" value="#ffa656"></button>

            <!-- <label for="secondary" id="secondary-text">Secondary color</label> -->
        </div>

        <div class="color">
            <!-- <input type="button" onclick="selectColor(this)" id="accent" name="accent" value="#3d0606"> -->
            <button class="input" onclick="selectColor(this)" id="accent" name="bg" value="#ffa656"></button>

            <!-- <label for="accent" id="accent-text">Accent color</label> -->
        </div>

        <div class="color">
            <!-- <input type="button" onclick="selectColor(this)" id="additional" name="additional" value="#822900"> -->
            <button class="input" onclick="selectColor(this)" id="additional" name="bg" value="#ffa656"></button>

            <!-- <label for="additional" id="additional-text">Additional color</label> -->
        </div>
    </div>

    <div class="color-cursor" id="cursor"></div>
    <div class="container">
        <canvas id="color-picker"></canvas>
    </div>

    <button onclick="savePalette()">Save palette</button>
    <div class="line"></div>

    </main>

</body>
<script src="color-picker.js""></script>
<script>
    window.addEventListener("load", (event) => {
        let color = document.cookie.split(";")[0];
        let colorValues = color.split("=")[1].split(",");
        
        console.log(colorValues);
        document.getElementById("bg").value = colorValues[0];
        document.getElementById("primary").value = colorValues[1];
        document.getElementById("secondary").value = colorValues[2];
        document.getElementById("accent").value = colorValues[3];
        document.getElementById("additional").value = colorValues[4];
    });

    Telegram.WebApp.ready();
    Telegram.WebApp.expand();

    function savePalette() {
        let data = {
            "bg": document.getElementById("bg").value,
            "primary": document.getElementById("primary").value,
            "secondary": document.getElementById("secondary").value,
            "accent": document.getElementById("accent").value,
            "additional": document.getElementById("additional").value
        }
        document.cookie = `color=${Object.values(data).join(",")}; expires=${365*24*60*60}; path=/`;
	    Telegram.WebApp.sendData(JSON.stringify(data)); 
        Telegram.WebApp.close();
    }
</script>
</html>
